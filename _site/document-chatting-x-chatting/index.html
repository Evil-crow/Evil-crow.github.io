<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/github.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script> <script>hljs.initHighlightingOnLoad();</script> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Chatting_X_Chatting项目文档 &#8211; Road to Coding</title> <meta name="description" content="只要那一抹笑容尚存, 我便心无旁骛"> <meta name="keywords" content=""> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/logo.png"> <meta name="twitter:title" content="Chatting_X_Chatting项目文档"> <meta name="twitter:description" content="对暑期项目完成的一份项目文档"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Chatting_X_Chatting项目文档"> <meta property="og:description" content="对暑期项目完成的一份项目文档"> <meta property="og:url" content="http://localhost:4000/document-chatting-x-chatting/"> <meta property="og:site_name" content="Road to Coding"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/document-chatting-x-chatting/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Road to Coding Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="Road to Coding photo" class="author-photo"> <h4>Road to Coding</h4> <p>只要那一抹笑容尚存, 我便心无旁骛</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:evilcrow486@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com/Evil-crow" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn" style="background-color:rgba(255,255,255,0.97);"> <div class="content"> <div class="post-title "> <h1>Chatting_X_Chatting项目文档</h1> <h4>22 Sep 2017</h4> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="chatting_x_chatting项目文档">Chatting_X_Chatting项目文档</h1> <p><em>暑期的项目文档,也真的是拖了好久才来完成,真的很差劲</em></p> <p><em>本项目的内容一切都是可以随意进行学习,使用的,但是切勿用于一切具有商业目的的用途上</em></p> <p><em>请于下载内的24小时内迅速删除</em></p> <h2 id="0目录">0.目录</h2> <ul> <li><a href="#1.引言">1.引言</a> <ul> <li><a href="#1.1项目综述">1.1项目综述</a></li> <li><a href="#1.2术语表">1.2术语表</a></li> <li><a href="#1.3参考资料">1.3参考资料</a></li> <li><a href="#1.4开发环境及使用工具">1.4开发环境及使用工具</a></li> <li><a href="#1.5使用说明">1.5使用说明</a></li> </ul> </li> <li><a href="#2.数据结构">2.数据结构说明</a></li> <li><a href="#2.模块设计">3.模块设计</a> <ul> <li><a href="#3.1程序函数调用图及模块分化">3.1程序函数调用图及模块分化</a></li> <li><a href="#3.2功能设计说明">3.2功能设计说明</a></li> </ul> </li> <li><a href="#4.文件说明">4.文件说明</a></li> <li><a href="#5.异常,错误处理">5.异常,错误处理</a></li> <li><a href="#6.已经存在的问题及改善方案">6.已经存在的问题及改善方案</a></li> <li><a href="#7.运行截图">7.运行截图</a></li> </ul> <h2 id="1引言">1.引言</h2> <h3 id="11项目综述">1.1项目综述</h3> <hr /> <p>随着网络的发展越来越快,地球越来越小,人与人之间的距离越来越小,<strong>实时通讯</strong>成为必须要实现的一个问题</p> <p>而在计算机发展史上,也不乏有各种各样的通讯工具的出现<strong>ICQ,MSN,Skype,QQ,Wechat,Yahoo!_Messager.</strong></p> <p>此项目是基于一些通讯软件的功能,再结合所学习到的<strong>进程,线程,网络通信</strong>的知识实现的一个通讯软件.</p> <p>仍然有许多的缺陷,但是已经初步具有实现通讯功能的能力.</p> <h3 id="12术语表">1.2术语表</h3> <hr /> <table> <thead> <tr> <th>序号</th> <th>术语</th> <th>说明性定义</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>C/S</td> <td>Client/Server模型</td> </tr> <tr> <td>2</td> <td>epoll</td> <td>Linux下处理并发的API</td> </tr> <tr> <td>3</td> <td>makefile</td> <td>Linux下进行工程构建的文件</td> </tr> </tbody> </table> <h3 id="13参考资料">1.3参考资料</h3> <hr /> <p>在进行该项目的实现时,也查阅了很多的资料</p> <blockquote> <p>a.相关类型的书籍</p> </blockquote> <blockquote> <table> <thead> <tr> <th>书籍</th> <th>作者</th> </tr> </thead> <tbody> <tr> <td>&lt; Linux_C编程实战 &gt;</td> <td>董永清</td> </tr> <tr> <td>&lt; 高性能Linux服务器构建实战 &gt;</td> <td>高俊峰</td> </tr> <tr> <td>&lt; 鸟哥的Linux私房菜(第三版)</td> <td>VBird</td> </tr> </tbody> </table> </blockquote> <blockquote> <p>b.查阅的相关的博客,网上资料</p> </blockquote> <blockquote> <table> <thead> <tr> <th>资料名</th> <th>作者</th> </tr> </thead> <tbody> <tr> <td><a href="http://blog.csdn.net/bgylde/article/details/53096739">Linux-C下C/S架构实例,实现文件传输功能</a></td> <td>bgylde</td> </tr> <tr> <td><a href="http://2627lounuo.blog.51cto.com/10696599/1784975">IO复用之——epoll</a></td> <td>敲完代码好睡觉zzz</td> </tr> </tbody> </table> </blockquote> <p><del>事实上,网路上,很多书上的内容都是千篇一律,很废的</del></p> <p><strong>但是,我很推荐上面”IO多路复用之—epoll”,剖析得很好</strong></p> <h3 id="14开发环境及使用工具">1.4开发环境及使用工具</h3> <p>开发环境: Fedora 4.11.12 X86_64</p> <p>开发工具: Vim及VSCode,gcc编译器</p> <p>绘图工具: ProcessOn</p> <h3 id="15使用说明">1.5使用说明</h3> <p>如果你曾经有过进行编程的经验,翻一翻目录就会知道该怎么使用了,</p> <p>但是你如果是初级小白,请按照我接下来的方法进行操作</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>安装说明:
cd ~/Public
git clone https://github.com/Evil-crow/Chatting_X_Chatting.git
cd Chatting_X_Chatting/v1.5/Client
make
make clean
cd ../Server
make
make clean

</code></pre></div></div> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>使用说明:

Terminal_I

cd Chatting_X_Chatting/v1.5/Server/
./Server

Terminal_II

cd Chatting_X_Chatting/v1.5/Client
./Client

之后,就可以按照提示进行使用

</code></pre></div></div> <p>此为本机测试方法,若要进行跨机器的通信,请发邮件至我的邮箱</p> <blockquote> <p>Evilcrow</p> </blockquote> <blockquote> <p>evilcrow486@gmail.com</p> </blockquote> <hr /> <h2 id="2数据结构说明">2.数据结构说明</h2> <p>本项目中主要是进行线程,进程,网络编程知识的综合运用</p> <p>所涉及到的数据结构并不是很多,主要是以下两种:</p> <table> <thead> <tr> <th>数据结构</th> <th>使用之处</th> </tr> </thead> <tbody> <tr> <td>数组</td> <td>使用数组,主要是在TCP发送包以及各种功能函数实现时所使用的.<br />存储字符串,标识符,各种各样的元素,这样可以使得功能的实现更加便利.<br />但是,在一定情况下,使用数组,并不能很好的提高程序的性能</td> </tr> <tr> <td>链表</td> <td>链表主要是在Server端使用,使用链表用来存储在线用户.<br />使用C语言不像其他OOP一样,有封装好的类,手动实现,虽然麻烦,但是后面很好使用.<br />,链表基本上,查找上相对慢一点,的那是其他操作很方便.</td> </tr> </tbody> </table> <h2 id="3模块设计">3.模块设计</h2> <h3 id="31程序函数调用图及模块分化">3.1程序函数调用图及模块分化</h3> <hr /> <h4 id="client">Client</h4> <p><img src="https://i.imgur.com/i29cDLM.png" alt="" /></p> <h4 id="server">Server</h4> <p><img src="https://i.imgur.com/5xhYBPf.png" alt="" /></p> <h3 id="32功能设计说明">3.2功能设计说明</h3> <hr /> <h4 id="321-clientmain模块">3.2.1 Client–main模块</h4> <hr /> <h5 id="功能描述">功能描述</h5> <p>此模块是进行Client总体控制的main模块</p> <h5 id="算法和流程图">算法和流程图</h5> <p><img src="https://i.imgur.com/K3BuFYz.png" alt="" /></p> <h4 id="322-clientrecv模块">3.2.2 Client–recv模块</h4> <hr /> <h5 id="功能描述-1">功能描述</h5> <p>此模块是Client进行接收包的recv模块</p> <h5 id="算法和流程图-1">算法和流程图</h5> <p><img src="https://i.imgur.com/d78hUjq.png" alt="" /></p> <h4 id="323-clientchat_data模块">3.2.3 Client–chat_data模块</h4> <hr /> <h5 id="功能描述-2">功能描述</h5> <p>此模块是进行Client聊天室的主体控制程序模块</p> <h5 id="算法与流程图">算法与流程图</h5> <p><img src="https://i.imgur.com/cyY3fbh.png" alt="" /></p> <h4 id="324-servermain模块">3.2.4 Server–main模块</h4> <hr /> <h5 id="功能描述-3">功能描述</h5> <p>此模块是Server总体控制的main模块</p> <h5 id="算法与流程图-1">算法与流程图</h5> <p><img src="https://i.imgur.com/nUsHYKB.png" alt="" /></p> <h4 id="325-serverepoll_server模块">3.2.5 Server–epoll_server模块</h4> <hr /> <h5 id="功能描述-4">功能描述</h5> <p>此模块是Server进行事件管理的重要的epoll模块</p> <h5 id="算法与流程图-2">算法与流程图</h5> <p><img src="https://i.imgur.com/pCzXwPa.png" alt="" /></p> <h3 id="326-serverepoll_menu模块">3.2.6 Server–epoll_menu模块</h3> <hr /> <h5 id="功能描述-5">功能描述</h5> <p>此模块是Server进行事件处理的模块</p> <h5 id="算法与流程图-3">算法与流程图</h5> <p><img src="https://i.imgur.com/hWXdRD5.png" alt="" /></p> <h2 id="4文件说明">4.文件说明</h2> <table> <thead> <tr> <th>文件名</th> <th>位置</th> <th>文件描述</th> </tr> </thead> <tbody> <tr> <td>buffer1</td> <td>~/Public/buffer1</td> <td>存储离线内容</td> </tr> <tr> <td>buffer2</td> <td>~/Public/buffer2</td> <td>存储离线信息位置</td> </tr> <tr> <td>File目录</td> <td>~/Public/File</td> <td>接受发送的文件</td> </tr> <tr> <td>[用户名]目录</td> <td>/Public/Information/[用户名]</td> <td>每一个用户建立一个目录,<br />其中包含了用户的好友目录,群组目录</td> </tr> <tr> <td>[好友名]目录</td> <td>~/Public/Information/[用户名]目录/[好友名]目录</td> <td>其中包含了buffer,history两个文件</td> </tr> <tr> <td>Groups目录</td> <td>~/Public/information/Groups目录</td> <td>其中包含了groups以及members两个文件</td> </tr> </tbody> </table> <h2 id="5异常错误处理">5.异常,错误处理</h2> <p>1.关于乱输入引发的错误</p> <p>解决方案:<strong>使用控制终端的方法进行选项的获取</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int getch(void)
{
     struct termios tm, tm_old;
     int fd = 0, ch;

     if (tcgetattr(fd, &amp;tm) &lt; 0) {//保存现在的终端设置
          return -1;
     }

     tm_old = tm;
     cfmakeraw(&amp;tm);//更改终端设置为原始模式，该模式下所有的输入数据以字节为单位被处理
     if (tcsetattr(fd, TCSANOW, &amp;tm) &lt; 0) {//设置上更改之后的设置
          return -1;
     }

     ch = getchar();
     if (tcsetattr(fd, TCSANOW, &amp;tm_old) &lt; 0) {//更改设置为最初的样子
          return -1;
     }

     return ch;
}
</code></pre></div></div> <p>2.在其他方面因为操作文件的错误</p> <p>解决方法:<strong>进行文件打开结果的判断,不合格打印错误提示消息,并且退出</strong></p> <h2 id="6已经存在的问题及改善方案">6.已经存在的问题及改善方案</h2> <p><strong>问题1:不合理的文件结构</strong></p> <p><strong>解决方案:分析实际程序的运行情况,一台主机仅绑定一个客户端,进行合理的文件结构分配</strong></p> <p><strong>问题2:对于不合理的输入</strong></p> <p><strong>解决方案:仍然需要继续进行非法输入的处理</strong></p> <h2 id="7运行截图">7.运行截图</h2> <p>1.file <img src="https://i.imgur.com/soOzFv6.gif" alt="" /></p> <p>2.friends <img src="https://i.imgur.com/SrQgs4b.gif" alt="" /></p> <p>3.groups <img src="https://i.imgur.com/vO4ws3m.gif" alt="" /></p> <p>4.history <img src="https://i.imgur.com/sriJJls.gif" alt="" /></p> <p>5.file <img src="https://i.imgur.com/m7erd3M.gif" alt="" /></p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/document-chatting-x-chatting/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/document-chatting-x-chatting/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/document-chatting-x-chatting/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'Evilcrow'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
