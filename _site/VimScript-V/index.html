<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/github.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script> <script>hljs.initHighlightingOnLoad();</script> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>VimScript的学习(五) &#8211; Road to Coding</title> <meta name="description" content="只要那一抹笑容尚存, 我便心无旁骛"> <meta name="keywords" content="VimScript"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/logo.png"> <meta name="twitter:title" content="VimScript的学习(五)"> <meta name="twitter:description" content="之前了解了VimScript作为脚本语言的基础,现在开始了解其中6种基本的变量类型"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="VimScript的学习(五)"> <meta property="og:description" content="之前了解了VimScript作为脚本语言的基础,现在开始了解其中6种基本的变量类型"> <meta property="og:url" content="http://localhost:4000/VimScript-V/"> <meta property="og:site_name" content="Road to Coding"> <meta property="og:image" content="http://localhost:4000/assets/img/logo.png"> <link rel="canonical" href="http://localhost:4000/VimScript-V/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Road to Coding Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/logo.png" alt="Road to Coding photo" class="author-photo"> <h4>Road to Coding</h4> <p>只要那一抹笑容尚存, 我便心无旁骛</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="mailto:evilcrow486@gmail.com" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-envelope-square"></i> Email</a> </li> <li> <a href="http://github.com/Evil-crow" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn" style="background-color:rgba(255,255,255,0.97);"> <div class="content"> <div class="post-title "> <h1>VimScript的学习(五)</h1> <h4>24 Oct 2017</h4> <a class="btn zoombtn" href="http://localhost:4000/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p><em>程序是用来操控数据的</em></p> <p><em>现在开始,我们来介绍VimScript中进行操作的6种变量类型</em></p> <p><em>数字,浮点型,字符串,列表,字典,函数引用(不做讨论)</em></p> <h2 id="数值">数值</h2> <p>在程序中操纵数据是再平常不过的事情了</p> <p>而数值类型则是一种很常见的变量类型,VimScript中有两种数值类型:数字与浮点型</p> <h3 id="数字">数字</h3> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo 100
echo 0xff
echo 017
echo 019
</code></pre></div></div> <p><img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_number.png" alt="" /> VimScript中支持使用八进制,十六进制进行数字的设定</p> <p>上面的示例中,显示了</p> <p>为什么最后一个是19</p> <p><strong>因为八进制没有9,按10进制处理,Vim会自动处理掉这个错误,所以建议一般写十进制为好</strong></p> <h3 id="浮点型">浮点型</h3> <p>浮点型,可以使用多种形式进行表示</p> <p>但是,<strong>不能使用echom,echom不接受浮点型</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo 100.1    #=&gt; 100.1
echo 5.45e+3  #=&gt; 5450.0
echo 5e10     #=&gt; Error!   并非是浮点型
</code></pre></div></div> <p><strong>当使用数值与浮点型混用时,Vim会强制转换类型,将所有的数值转换为浮点型</strong></p> <p><strong>以Float形式作为结果</strong></p> <h2 id="字符串">字符串</h2> <p>字符串,是一个很大的类型,为什么这么说呢?</p> <p><strong>因为VimScript就是用来处理文本的,所以字符串是一个很大的类型,Ruby,Perl也是如此</strong></p> <h3 id="字符串的连接">字符串的连接</h3> <p><code class="highlighter-rouge">echo "Hello," + "World"</code></p> <p>是不会生效的,因为”+”运算符只适用与数值类型与列表类型,对于字符串是不适用的</p> <p><strong>强行使用,会将字符串强转为数值类型,(转换规则之前已经提到过了)</strong></p> <p>对于字符串,使用<strong>连接运算符</strong>进行字符串的的连接</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "Hello ," . "World"    #=&gt; "Hello,World"
echo 10 . "abc"             #=&gt; "10abc"
echo 10.1 . "foo"           #=&gt; Error!   Float不能转换为字符串
</code></pre></div></div> <p>**这就是VimScript不善解人意的地方 : **</p> <p><strong>可以在进行 “ + “ 运算时,将String转为数值</strong></p> <p><strong>但是, “ . “ 运算时不能将Float转换为String</strong></p> <p><strong>所以,建议在VimScript书写时,如果需要即进行变量类型的转换时,请显式的进行类型准换</strong></p> <p><strong>不要依赖于Vim自身的类型转换,不靠谱,出来混迟早是要还的</strong></p> <h3 id="转义字符">转义字符</h3> <p>同其他的编程语言一样,对于不能进行输入的字符,可以使用转义字符来进行处理</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "foo\"bar\""   #=&gt; foo"bar"
echo "foo\nbar"     #=&gt; foo&lt;换行&gt;bar
echom "foo\nbar"    #=&gt; foo^@bar   echom 会将一些特殊字符进行输出,而不是进行功能性输出
</code></pre></div></div> <p>对于这种echom诡异的情况,就要使用字符串字面量,来进行处理</p> <h3 id="字符串字面量">字符串字面量</h3> <p>为了上面的转义字符滥用的情况,所以我们使用字符串字面量来进行处理</p> <p><strong>字符串字面量:所见即所得,几乎没有转义的情况</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echom 'foo\nbar'  #=&gt; "foo\nbar"
echo 'that''s'   #=&gt; "that's"
</code></pre></div></div> <p>** ‘ ‘ 即是唯一的例外,进行转义,其余所有的字符串都是不会进行转义的**</p> <h2 id="字符串函数">字符串函数</h2> <p>前面提到了这么多的字符串,那么其进行处理的字符串函数也是有很多的</p> <ul> <li>长度</li> </ul> <p>类似于C语言,使用strlen(string-length)来进行字符串长度的求解</p> <p>len函数也是可以使用的,但是len函数也用在列表求解时使用</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo strlrn("foo")
echo len("foo")
</code></pre></div></div> <p><img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_strlen.png" alt="" /></p> <ul> <li>切割</li> </ul> <p>可以按照指定的字符将字符串切割成列表</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo split("abc")
echo split("a,b,c",",")
</code></pre></div></div> <p><img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_split.png" alt="" /> <img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_split,,,.png" alt="" /></p> <ul> <li>连接</li> </ul> <p>对于字符串的连接处理,是类似于列表的,好吧,其实就是列表</p> <p>使用join函数,将字符串使用指定的连接符进行连接</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo join(["abc","def"],"--")
echo join(["abc,"def"])
</code></pre></div></div> <p><strong>第三个参数缺省的情况下,使用空格进行字符串符的连接</strong></p> <p><strong>split函数与join函数合作十分密切</strong></p> <ul> <li>大小写的转换</li> </ul> <p>这个可就真的是类似于C了</p> <p>使用tolower( )以及toupper( )函数进行大小写转换</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo tolower("Foo")
echo toupper("Foo")
</code></pre></div></div> <p><img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_lower.png" alt="" /> <img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_upper.png" alt="" /></p> <h2 id="列表">列表</h2> <p>列表,也可以叫做有序链表.</p> <p>对Python,我基本没学过,从Ruby的角度来讲,基本同Array</p> <p>(不多说了,毕竟什么语言就是什么语言,不能整天在类比)</p> <p><strong>VimScript的列表是有序的,异质的元素集合</strong></p> <p><strong>列表中可以嵌套列表</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo [1,2,3]  #=&gt; [1,2,3]
echo [[1,2],3] #=&gt; [[1,2],3]
</code></pre></div></div> <h3 id="索引index">索引(index)</h3> <p>列表,是有序的集合,所以输出列表需要依靠索引</p> <p>索引,简单地来讲,就是下标</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo [1,2,3][0] #=&gt; 1
echo [1,[2,3]][1] #=&gt; [2,3]
</code></pre></div></div> <p>同时,VimScript还可以进行反向索引,反向索引的时候,</p> <p><strong>-1为最后一个元素,-2为倒数第二个元素,以此类推</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo [1,2,3][-1]  #=&gt; 3
echo [[1,2],3][-2]  #=&gt; [1,2]
</code></pre></div></div> <h3 id="切割">切割</h3> <p>切割即将列表中的元素按照需要的顺序进行切割并显示</p> <p>举个例子:</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo [1,2,3,4][1:2]   #=&gt; [2,3]
echo [1,2,3,4][-2:-1] #=&gt; [3,4]
echo [1,2,3,4][:2]    #=&gt; [1,2,3]
echo [1,2,3,4][3:]    #=&gt; [4]
</code></pre></div></div> <p>有上面的例子可以看出,切割需要注意的点有:</p> <ul> <li> <p>切割时的索引也是从0开始</p> </li> <li> <p>切割必须遵守列表顺序,否则为空</p> </li> <li> <p>切割可以反向索引,但是必须遵守第二条</p> </li> <li> <p>切割时,左缺省置为0,右缺省值为最大值</p> </li> </ul> <p><strong>可以使用负数索引列表,但是不能使用负数索引字符串!</strong></p> <p>这个例子,直观又贴切</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo "abcd"[-1] . "abcd"[-2:-1]
</code></pre></div></div> <p><img src="http://oww4cv296.bkt.clouddn.com/VimScript%28V%29_cd.png" alt="" /></p> <p><strong>第一个字符串索引值为空,得到一个空的字符串.</strong></p> <p><strong>第二个字符串进行切割,获得的结果cd, “ . “ 连接运算符的结果是”cd”</strong></p> <h3 id="连接">连接</h3> <p>想要连接Vim中的列表,直接 “+”就可以了</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo ['a','b'] + ['c']   #=&gt; ['a','b','c']
</code></pre></div></div> <h3 id="列表函数">列表函数</h3> <p>上面这些都是些正常的列表操作,当然列表也是有很多的函数的</p> <ul> <li>add( )函数</li> </ul> <p><strong>用于进行列表的扩展使用,即给列表后添加内容</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let foo = ['a']
call add(foo,'b')
echo foo            #=&gt; ['a','b']
</code></pre></div></div> <ul> <li>get( )函数</li> </ul> <p>用于进行列表值的获取,基本用法</p> <p><code class="highlighter-rouge">get(List,index,'default')</code></p> <p><strong>获取List列表中,索引为index的元素,若元素不存在,则将’default’作为结果,default缺省值为0</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>foo = ['a','b']
let a = get(foo,1,'default')
let b = get9foo,2,'default')
echo a         #=&gt; 'b'
echo b         #=&gt; 'default'
</code></pre></div></div> <ul> <li>index( )函数</li> </ul> <p><strong>用于返回List中元素的索引,若元素不存在,则返回-1</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo index([1,2,3],1)       #=&gt; 0
echo index([1,2,3],"1")     #=&gt; -1
</code></pre></div></div> <ul> <li>join( )函数</li> </ul> <p>其实这个函数,之前在字符串的部分已经见过了.</p> <p>但是,当时只是为了进行字符串的连接使用</p> <p>实际上,join( )函数,是进行列表元素的连接使用</p> <p><strong>将列表元素按照给定的连接字符进行连接成为字符串,若非字符串的项,强转为字符串</strong></p> <p><strong>连接符的缺省值为空格</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let foo = [1,2,3]
echo join(foo,",")    #=&gt; 1,2,3
echo join(foo)        #=&gt; 1 2 3
echo join(foo,"")     #=&gt; 123
</code></pre></div></div> <ul> <li>reverse( )函数</li> </ul> <p><strong>不需要多说,很简单的就地转置函数,将列表进行转置</strong></p> <h2 id="字典">字典</h2> <p>最后的一种数据类型了,字典这种数据类型在很多语言中都是存在的</p> <p><strong>Python中的dict,Ruby中的hash,JavaScript中的Object,都是类似的key-value键值对</strong></p> <p>字典用花括号创建,值是异质的,但是会被强转为字符串</p> <p>**因为value只能是字符串啊 ! **</p> <p>Vim将value强转为字符串,但是保持值不变</p> <p><strong>同时,VimScript改进了JavaScript中的蠢笨之处,字典末尾是可以保留逗号的</strong></p> <p><strong>建议在字典末尾保留 , (逗号),便于字典元素换行时,可以保证不会出现添加元素缺少逗号的问题</strong></p> <h3 id="索引">索引</h3> <p>既然数据类型相似,那么语言之间进行字典的索引基本都是相同的,对没错,使用键进行访问即可</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>foo = {'a':"1",'b':"2"}
echo foo['a']          #=&gt; 1
echo foo[b]            #=&gt; 2
</code></pre></div></div> <p>同时,<strong>如果,键key仅由字母/下划线组成时,VimScript也支持JavaScript风格的 ‘ . ‘查找</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo foo.a    #=&gt; 1
echo foo.b    #=&gt; 2
</code></pre></div></div> <h3 id="赋值与添加">赋值与添加</h3> <p>赋值与添加新项的操作是一样的</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let foo = {1:"a",2:"b",}
let foo.1 = "c"
let foo.3 = "d"
echo foo          #=&gt; {'1':'c','2':'b','3':'d'}
</code></pre></div></div> <h3 id="移除项">移除项</h3> <p>进行字典项的移除时,有两种方法</p> <ol> <li> <p>使用remove函数</p> </li> <li> <p>使用unlet命令</p> </li> </ol> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unlet foo.3
echo foo           #=&gt; {'1':'c','2':'b',}
let test = remove(foo,2)
echo foo           #=&gt; {'1':'c'}
echo test          #=&gt; b
</code></pre></div></div> <p><strong>remove函数可以移除项,并且返回被移除的项值,unlet函数能做的,remove都可以</strong></p> <p><strong>所以,建议使用remove函数,同时,你不能移除不存在的项,会抛出异常</strong></p> <h3 id="字典函数">字典函数</h3> <p>同理于列表,字典也是存在许多的字典函数的</p> <p>存在着类似的get( )函数</p> <ul> <li>get( )函数</li> </ul> <p><code class="highlighter-rouge">get(Dict,index(key),default)</code>类似于List的get函数</p> <ul> <li>has_key( )函数</li> </ul> <p><strong>用于判断Dict是否存在改建值对,返回1/0</strong></p> <p><strong>可以用此来判断真假</strong></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>echo has_key({'a':100},'a')  #=&gt; 1
echo has_key({'a':100},'a')  #=&gt; 0
</code></pre></div></div> <ul> <li>items( )函数</li> </ul> <p>可以使用items( )函数查看该Dict中所有的键值对,<strong>获取结果为嵌套列表</strong></p> <p><strong>但是,切记items( )中的键值对是无序的</strong></p> <p><strong>同时,使用keys,values可以获得,键,值的所有值</strong></p> <p>至此,所有的VimScript的数据类型已经介绍完毕了</p> <p>在理接的过程中,我也是觉得,使用help命令十分的重要,可以帮助你学习很多注意不到地方</p> <p>同时,也请注意进行规范的操作,</p> <p><strong>Vim会自动的将一些错误进行抹除,严重的影响程序设计</strong></p> <p>目前关于VimScript的学习暂时到此,下面我会进行一段时间插件开发的学习,之后再进行总结</p> <p>October 25, 2017 9:41 PM</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#VimScript" title="Pages tagged VimScript" class="tag"><span class="term">VimScript</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/VimScript-V/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/VimScript-V/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/VimScript-V/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'Evilcrow'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
